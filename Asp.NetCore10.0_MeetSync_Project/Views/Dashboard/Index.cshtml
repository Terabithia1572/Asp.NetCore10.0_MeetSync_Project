@{
    Layout = "_MeetSyncLayout";
    ViewData["Title"] = "Lobby";
}

<main class="flex-1 flex flex-col items-center justify-center p-6 lg:p-12">
    <div class="w-full max-w-2xl space-y-8">
        <div class="text-center space-y-2">
            <h2 class="text-slate-500 dark:text-slate-400 font-medium text-lg">Welcome back, @ViewBag.UserName</h2>
            <h3 class="text-4xl md:text-5xl font-black tracking-tight text-slate-900 dark:text-white">Ready to connect?</h3>
        </div>

        <div class="bg-white dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 rounded-xl p-8 shadow-2xl shadow-primary/5">
            <div class="space-y-6">
                <div class="flex justify-center gap-4 mb-6">
                    <button id="lobby-mic" onclick="togglePref('mic')" class="size-14 rounded-full bg-primary flex items-center justify-center shadow-lg transition-all active:scale-90">
                        <span class="material-symbols-outlined text-white">mic</span>
                    </button>
                    <button id="lobby-cam" onclick="togglePref('cam')" class="size-14 rounded-full bg-primary flex items-center justify-center shadow-lg transition-all active:scale-90">
                        <span class="material-symbols-outlined text-white">videocam</span>
                    </button>
                </div>

                <form asp-action="JoinRoom" method="post" class="space-y-4">
                    <div class="relative">
                        <span class="material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-slate-400">link</span>
                        <input name="roomName" required class="w-full pl-12 pr-4 py-4 bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-primary/20 outline-none transition-all text-white" placeholder="Enter Room Name" type="text" />
                    </div>
                    <button type="submit" class="w-full bg-primary hover:bg-primary/90 text-white font-bold py-4 px-6 rounded-xl shadow-lg transition-all flex items-center justify-center gap-2">
                        <span class="material-symbols-outlined">login</span> Join Meeting
                    </button>
                </form>

                <div class="flex flex-wrap items-center justify-center gap-6 text-sm text-green-500 font-medium">
                    <div id="cam-status" class="flex items-center gap-2"><span class="material-symbols-outlined text-[18px]">videocam</span> Camera ready</div>
                    <div id="mic-status" class="flex items-center gap-2"><span class="material-symbols-outlined text-[18px]">mic</span> Mic connected</div>
                </div>
            </div>
        </div>
    </div>
</main>

@section Scripts {
    <script>
        localStorage.setItem("pref_mic", "true");
        localStorage.setItem("pref_cam", "true");

        function togglePref(type) {
            let current = localStorage.getItem("pref_" + type) === "true";
            localStorage.setItem("pref_" + type, !current);
            const btn = document.getElementById("lobby-" + type);
            btn.classList.toggle("bg-red-600", current);
            btn.classList.toggle("bg-primary", !current);
            btn.querySelector('span').textContent = type === "mic" ? (current ? "mic_off" : "mic") : (current ? "videocam_off" : "videocam");
        }
    </script>
}